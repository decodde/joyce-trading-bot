let switchTo = async (x) => {
    //console.log(x)
    var views = document.getElementsByClassName('view');
    //console.log(views)
    for (var i = 0; i < views.length; i++) {
        views[i].classList.replace('h-show', 'h-hide');
    }
    if (x == '1') {
        //console.log('1)')
        document.getElementById('binanceKeys').classList.replace('h-hide', 'h-show');
    }
    else if (x == '2') {
        //console.log('2)')
        document.getElementById('startBot').classList.replace('h-hide', 'h-show');
    }
    else if (x == '3') {
        //console.log('3)')
        document.getElementById('stopBot').classList.replace('h-hide', 'h-show');
    }
    else if (x == "4"){
        var agreement = `Customer Agreement

        This agreement is between The Rocket125x Team & The Users, which is situated in Nigeria. This agreement describes the mechanism of interaction of the subjects of economic relations in the security of personal data.
        
        1. Use and Protection of Personal Information of Users
        
        1.1. For cooperation with the administration of the Automated Trading Bot, for personal use, you need to register and provide your personal and contact details. During the registration process you will need to provide your real first and last name, email address, physical address with zip code and phone number (please include country code). Content Management System (CMS) of website also collects about you further information such as your IP address and geographic location of the entrance to the site, the type of web browser and the Operating System (OS) of your device, which you use to Internet surfing.
        1.2. Personal (contact) information will be used by the administration of the investment project in the following cases:
        1.2.1. If you lose your data to enter into a personal account (your username and/or password). To restore such data you will need to use an email address that was provided during registration. Your username / password will be emailed in automatic mode.
        1.2.2. After changing the settings of your account, you will receive a confirmation by email.
        1.2.3. After completion of registration, the creation of deposit Withdrawal requests and reports about completes of these transactions.
        1.2.4. Your contact details will be used for promptly informing users about marketing activities, special offers and news. At any time you may be permitted to cancel your subscription by sending us a request with the subject line "Unsubscribe" via email@domain.com. which will take up to 7days to process or in some cases even more than 
        
        2. The Sharing of Personal User Information with a Third Party
        
        2.1. Rocket125x adheres to the principles of confidentiality of personal information and never discloses personal information of the project participants to third parties. However, in some situations we will have to transfer the data of our users. Such case could happen if the customer has violated the law, and we got an appropriate court order.
        2.2. We will be forced to disclose personal information of our customers if their actions violate the rules of the project or discredit his reputation.
        2.3. The user's account may be blocked if we suspect any fraudulent activity, and we can write a statement to law enforcement agencies and to provide user's information (his personal data, size and date of deposit).
        2.4. We may also disclose information about the user, if he asks us about it, or will be agreed in advance to such transfer of stakeholders.
        
        3. Security of Personal Data of Users
        
        3.1. The security of any personal information is most important to us. By registering on the official website of the company, you can be sure that all the information we collect will only be used as an internal information database. We ensure maximum security of all data channels and eliminate any possibility of illegal theft of information. We do not claim leadership in the field of information security, but we have optimized our website in such a way that customers have nothing to worry about. All data channels are encrypted using the most modern means of protection: SSL certificate and reliable web hosting with protection from external threats (including DDoS attacks).
        3.2. All information submitted by you will be stored on our servers as long as your account is active. If you do not use your account a certain time, it does not mean that it is automatically deleted. To delete your account, you will need to contact administration of this application with a similar request. You must submit this request to the same email account that was used to register your account. After a thorough check your request will be processed within 7 working days. You will be notified that your account has been removed from our information base. To contact the administration concerning data security, the latest information and change or delete your personal account, you must use email@domain.com.
        
        4. Additional Information on the Management of User Data
        
        4.1. The application does not change your data at its discretion. For any changes you need to, send us a request, via the support section. Always use the same email address, it will help us identify and get rid of extra checking. Upon receipt of your request for information in your account will be updated within 7 working  days. After changing the data, you will be notified via email.
        4.2. We strongly recommend that you comply to the rules of payment & earning and also view News section on our website.
        
        5. Feedback
        
        5.1. If you have any questions or issues relating to the security and storage of your contact details or you have important information about violations while working with the trading bot, do not hesitate to contact us. Customer service operates at your best friendly state. You can use only e-mail to contact us for now as we are working on getting more platforms for communications.
        You agree to be of legal age in your country to partake in this trading bot, and in all the cases your minimal age must be 18 years.
        
        Every trading activities is considered to be a private transaction between the Rocket125x and its Team.
        
        As a private transaction, this trading bot & it's team are exempt from CAMA Company and allied matters act. We are not a licensed bank or a security firm.
        
        You agree that all information, communications, materials coming from Rocket125x are unsolicited and must be kept private, confidential and protected from any disclosure. Moreover, the information, communications and materials contained herein are not to be regarded as an offer, nor a solicitation for investments in any jurisdiction which deems non-public offers or solicitations unlawful, nor to any person to whom it will be unlawful to make such offer or solicitation.
        
        All the data given by a member to Rocket125x will be only privately used and not disclosed to any third parties. Rocket125x & it's team are not responsible or liable for any loss of data & fund.
        
        You agree to hold all principals and members harmless of any liability. You are trading at your own discretion and risk also you agree that a past performance is not an explicit guarantee for the same future performance because od the volatility of the crypto market. You agree that all information, communications and activities you will find on this trading bot is intended to be regarded as an informational tool and educational matter and not a financial or an investment advice.
        
        We reserve the right to change the rules, commissions and rates of the program at any time and at our sole discretion with short or no prior notice, especially in order to respect the integrity and security of the team members' interests. You agree that it is your sole responsibility to review the current terms.
        
        Crypto breakthrough academy or Rocket125x is not responsible or liable for any damages, losses and costs resulting from trades using the bot or any violation of the conditions and terms and/or use of our bot by a member. You guarantee to Crypto Breakthrough Academy & Rocket125x team members that you will not use this automated trading bot in any illegal way and you agree to respect your local, national and international laws. Maintenance of the not cab occur anytime and that will require some updates, we'll try as much as possible that it doesn't affect trades /fund but should it does we are not to be held responsible. Also you agree that it's your responsibility to always check if there's an update on the bot. 
        
        Don't post bad vote on Public Forums and at Gold Rating Site without contacting getting a go ahead from the administrator of project FIRST. Maybe there was a technical problem with your transaction, so please always CLEAR the every matter with the administrator.
        
        We will not tolerate SPAM or any type of UCE in this project. SPAM violators will be immediately and permanently removed from the project.
        
        Crypto Breakthrough Academy and Rocket125x team reserves the right to either accept or decline any member for membership without explanation or refund.
        
        Having agreed with all the above, please sign up.
        
        © Cryptobreakthroughacademy.
        © Rocket125x
         Actualizing Your Financial Dreams`;
        
        document.getElementById('agree').value = agreement;
        document.getElementById('disclaimer').classList.replace('h-hide', 'h-show');
    }
}

let edit = async () => {
    document.getElementById("apiKey").removeAttribute('disabled');
    document.getElementById("apiSecret").removeAttribute('disabled');
}

document.getElementById('binanceKeys').onsubmit = (async (e) => {
    e.preventDefault();
    //console.log('binanceK')
    var apiKey = document.getElementById('apiKey').value;
    var apiSecret = document.getElementById('apiSecret').value;

    var opt = {
        method: 'POST',
        headers: {
            'content-type': 'application/json'
        },
        body: JSON.stringify({
            apiKey: apiKey,
            apiSecret: apiSecret
        })
    }
    try {
        var _req = await fetch('/submitKeys', opt);
        _req = await _req.json();
        if (_req.type == "success") {
            //notify success
            document.getElementById('apiSecret').setAttribute('disabled', '');
            document.getElementById('apiKey').setAttribute('disabled', '');
            console.log(_req)
            notify('s',_req.msg);
        }
        else if (_req.type == "error") {
            notify('e',_req.msg);
        }
        else {
            console.log(_req);
            notify('e','Could not connect to rocket125x server. Connection issues?')
        }
    }
    catch (e) {
        console.log(e);
        notify('e','Could not connect to rocket125x server. Connection issues?')
    }
})

var logout = async () => {
    var opt = {
        method: 'POST',
        headers: {
            'content-type': 'application/json'
        },
        body: JSON.stringify({
        })
    }
    try {
        var _req = await fetch('/logout', opt);
        _req = await _req.json();
        if (_req.type == "success") {
            console.log(_req)
            window.location.href = "/";
            notify('s','Logged out');
        }
        else {
            console.log()
            notify('e',`Error logging out, ${_req.msg}`);
            notify('e',`Redirecting to login`);
            window.location.href = "/";
        }
    }
    catch (e) {
        notify('e','Could not connect to rocket125x server. Connection issues?');
        window.location.reload()
        console.log(e);
    }
}

var notify = (type, msg) => {
    var not = document.createElement('not');
    if (type == "e") {
        not.innerHTML = `<div class="h-anim-rollin notify notify-error">
                            <p class="h-text">
                                ${msg}
                            </p>
                        </div>`
    }
    else {
        not.innerHTML = `<div class="notify notify-success">
                            <p class="h-text">
                                ${msg}
                            </p>
                        </div>`
    }
    document.body.append(not);
    setTimeout(() => {
        not.remove()
    }, 3000);
}
document.getElementById('startBot').onsubmit = (async (e) => {
    e.preventDefault();
    console.log('=======startBot========');
    var strategy = document.getElementById('strategy').value;
    var symbol = document.getElementById('symbol').value;
    var leverage = document.getElementById('leverage').value;
    var minNotional = document.getElementById('minNotional').value;
    var quantityPrecision = document.getElementById('quantityPrecision').value;
    var opt = {
        method: 'POST',
        headers: {
            'content-type': 'application/json'
        },
        body: JSON.stringify({
            strategy: strategy,
            symbol: symbol,
            leverage: leverage,
            minNotional : minNotional,
            quantityPrecision : quantityPrecision
        })
    }
    try {
        var _req = await fetch('/botOrder', opt);
        _req = await _req.json();
        if (_req.type == "success") {
            console.log(_req)
            window.location.reload();
            notify('s','Bot started');
        }
        else {
            console.log()
            notify('e',_req.msg);
        }
    }
    catch (e) {
        notify('e','Could not connect to rocket125x server. Connection issues?');
        console.log(e);
    }
});

let leverageCheck = async () => {
    var _lev = document.getElementById('leverage');
    var lev = document.getElementById('leverage').value;
    lev = Number(lev);
    if(lev >= 1 && lev <= _lev.max){
        console.log("Good Good")
    }
    else {
        notify('e','Leverage is invalid');
        document.getElementById('leverage').value = 20;
    }
}
let symbolInfo = async () => {
    var symbol = document.getElementById('symbol').value;
    
    try{
        var _req = await fetch("/getSymbolInfo");
        _req = await _req.json();
        
        if(_req.type == "success"){
            var _sym = _req.data;
            _sym = _sym.filter(o => {
                if(o.pair == symbol){
                    return o;
                }
            })
            var __sym = _sym[0];
            console.log(__sym)
            var quantityPrecision = __sym.quantityPrecision;
            console.log('quant:>:  ',quantityPrecision);
            document.getElementById('quantityPrecision').value = quantityPrecision;
            var minNotional = __sym.filters.find(o=>o.filterType == 'MIN_NOTIONAL');
            document.getElementById('minNotional').value = minNotional.notional;
            
            try{
                console.log("here")
                var _opt = {
                    method : 'POST',
                    headers : {
                        "Content-type" : "application/json"
                    },
                    body : JSON.stringify({
                        symbol : symbol
                    })
                }
                var __req = await fetch("/getLeverage",_opt);
                __req = await __req.json();
                console.log(__req)
                var _lev = document.getElementById('leverage');
                _lev.max = __req.data[0].brackets[0]['initialLeverage'];
                console.log(_lev);
            }
            catch(e){

            }
        }
        else{
            console.log(_req)
            notify('e',`Could not get ${symbol} info`);
        }
    }
    catch(e){
        console.log(e);
        notify('e', 'Error getting symbol info; Probably network issues?');
    }
}

let stopBot = async () => {
    var opt = {
        method: 'POST',
        headers: {
            'content-type': 'application/json'
        }
    }
    try {
        var _req = await fetch('/stopBot', opt);
        _req = await _req.json();
        if (_req.type == "success") {
            notify('s', 'Successfully stopped bot');
            window.location.reload();
        }
        else {
            notify('e', 'Error stopping bot');
            console.log(_req);
        }
    }
    catch (e) {
        console.log(e);
        notify('e', 'Error stopping bot; Probably network issues?');
    }
}